{% extends '/careers/base_job-details.html' %}

{% block extra_metatags %}
  <meta name="robots" content="noindex">
{% endblock %}

{% block content %}
  <script>
    function showProgressDetail(stage) {
    const showMoreBtn = document.querySelector(`.show-more-${stage}`);
    const detail = document.querySelector(`.progress-detail-${stage}`)
    if ( detail.classList.contains("u-hide")) {
      detail.classList.remove("u-hide")
      showMoreBtn.innerHTML="Show less"
    } else {
      detail.classList.add("u-hide")
      showMoreBtn.innerHTML="Show more"
    }
  }
  </script>
  {% if application["status"] == "active" %}
    <section class="p-strip--light is-deep">
      {% if withdrawal_requested %}
        <div class="u-fixed-width">
          <div class="p-notification--caution">
            <div class="p-notification__content">
              <h5 class="p-notification__title"> You have requested to withdraw this application</h5>
              <p class="p-notification__message">Your application will remain active until you click on the link we have sent you via email.</p>
            </div>
          </div>
        </div>
        {% if debug_skip_sending %}
            <!--
              We want to make it very clear when sending has been skipped, so we don't accidentally
              end up skipping sending the email in production in a silent way that nobody notices.
            -->

          <div class="u-fixed-width">
            <div class="p-notification--caution">
              <div class="p-notification__content">
                <h5 class="p-notification__title">[DEBUG] This email wasn't sent because you're in debug mode</h5>
                <p>The following email would have been sent to {{ candidate_email }}:</p>
                <p><blockquote>{{ email_message | safe }}</blockquote></p>
              </div>
            </div>
          </div>
        {% endif %}
      {% endif %}

      {% if wrong_email %}
        <div class="u-fixed-width">
          <div class="p-notification--caution">
            <div class="p-notification__content">
              <h5 class="p-notification__title">We could not withdraw your application.</h5>
              <p class="p-notification__message">The email you entered does not match the email used to apply to this role. Please try again using the email you used in the application.</p>
            </div>
          </div>
        </div>
      {% endif %}

      <div class="row">
        <h1>Thanks for applying {{ application["candidate"]["first_name"] }}!</h1>
        {% if application['source']['id'] == 2 %}
          <p>You applied for the role: <a href="/careers/{{ application['job_post_id'] }}"><strong>{{ application["jobs"][0]["name"] }}</strong></a></p>
        {% else %}
          <p>You applied for the role: <strong>{{ application["jobs"][0]["name"] }}</strong></p>
        {% endif %}
        {% if application.get("hiring_lead") %}
          <p>
            Your hiring lead is {{ application["hiring_lead"]["name"] }}
            (<a href="mailto:{{ application['hiring_lead']['primary_email_address'] }}">{{ application["hiring_lead"]["primary_email_address"] }}</a>)
          </p>
        {% endif %}
      </div>
    </section>

    <section class="p-strip is-deep">
      <div class="u-fixed-width">
        <h2 class="p-heading--4">Your application process</h2>
        <p class="u-sv2">Once your application is accepted, you will see more details about its status. <a>See what our CEO says about our hiring process</a>.</p>
      </div>
      <div class="u-fixed-width">  
        <ol class="p-stepped-list--detailed p-list--divided">
          <li class="p-stepped-list__item">
            <h3 class='p-process-stepped-list__title u-no-margin--bottom'>
              {% if "stage_progress" in application and application["stage_progress"]["assessment"] %}<span class="p-on-pass"><i class="p-icon--success"></i> </span>
              {% elif "stage_progress" in application and not application["stage_progress"]["assessment"] and application["stage_progress"]["application"] %}
              <span class="p-on-stage"></span> 
              {% else %}<span class="p-not-on-stage"></span> 
              {% endif %}
              Application review
            </h3>
            <p class="p-stepped-list__content">An experienced Hiring Lead from our business will review your CV submission against the job criteria set for this role.</p>
          </li>
          <li class="p-stepped-list__item">
            <h3 class='p-process-stepped-list__title u-no-margin--bottom'>
              {% if "stage_progress" in application and application["stage_progress"]["early_stage"] %}<span class="p-on-pass"><i class="p-icon--success"></i> </span>
              {% elif "stage_progress" in application and not application["stage_progress"]["early_stage"] and application["stage_progress"]["assessment"] %}
              <span class="p-on-stage"></span> 
              {% else %}<span class="p-not-on-stage"></span> 
              {% endif %}
              Assessment
            </h3>
            <div class="p-stepped-list__content">
              {% if "stage_progress" in application and application["stage_progress"]["early_stage"] %}
              <p>There are three parts to this stage:</p>
              <p onclick="showProgressDetail('assessment')" class="show-more-assessment">Show more</p>
              <div class="progress-detail-assessment u-hide">
              {% else %} <div class="progress-detail-assessment">
              {% endif %}
              {% if not application["scheduled_interviews"] %}
                  <p>There are several parts to this stage: a written interview, a psychometric assessment and some roles will require a technical assignment to be completed.</p>
                  {% else %}
                    <ol class="p-stepped-list">
                      <li class="p-stepped-list__item">
                        <p class='p-stepped-list__title u-no-margin--bottom'>The Written Interview: As the first part of this stage we invite you to submit your answers to some questions specifically designed so that we can find out more about your experience and skill set. We ask that you submit this anonymously to ensure our hiring process is bias free. This is your opportunity to highlight your key strengths for this position.</p>
                      </li>
                      <li class="p-stepped-list__item">
                        <p class='p-stepped-list__title u-no-margin--bottom'>Psychometric assessment: As part of our professional review this assessment will help us to understand your fluid intelligence and behavioural traits.</p>
                      </li>
                      <li class="p-stepped-list__item">
                        <p class='p-stepped-list__title u-no-margin--bottom'>Technical tests: Some roles will require a technical assignment to be completed.</p>
                      </li>
                    </ol>
                    {% for interview in application["scheduled_interviews"]|reverse %}
                        {% if interview["interview"]["name"] == "Meet & Greet Interview" and now("%Y%m%d") > interview["start"]["datetime"].strftime('%Y%m%d') %}
                            <hr />
                            <h5>Past interviews</h5>
                            {% include 'careers/application/_interview-card-done.html' %}
                        {% endif %}
                    {% endfor %}
                    </ul>
                    {% for interview in application["scheduled_interviews"] %}
                        {% if interview["interview"]["name"] == "Meet & Greet Interview" and now("%Y%m%d") < interview["start"]["datetime"].strftime('%Y%m%d') %}
                            <hr />
                            <h5>Next interview</h5>
                            {% include 'careers/application/_interview-card.html' %}
                        {% endif %}
                    {% endfor %}
                    </ul>
              {% endif %}
              </div>
            </div>
          </li>
          <li class="p-stepped-list__item">
            <h3 class='p-process-stepped-list__title u-no-margin--bottom'>
              {% if "stage_progress" in application and application["stage_progress"]["late_stage"] %}<span class="p-on-pass"><i class="p-icon--success"></i> </span>
              {% elif "stage_progress" in application and not application["stage_progress"]["late_stage"] and application["stage_progress"]["early_stage"] %}
              <span class="p-on-stage"></span> 
              {% else %}<span class="p-not-on-stage"></span> 
              {% endif %}
              Early stage
            </h3>
            <div class="p-stepped-list__content">
              <p>Our interviews are a blend of technical and competency based interviews. If successful you will pass through to an interview with our HR team.</p>
              {% if "stage_progress" in application and application["stage_progress"]["late_stage"] %}
              <p onclick="showProgressDetail('early-stage')" class=" show-more-early-stage">Show more</p>
              <div class="progress-detail-early-stage u-hide">
              {% else %}
              <div class="progress-detail-early-stage">
              {% endif %}
                {% for interview in application["scheduled_interviews"]|reverse %}
                    {% if (interview["interview"]["name"]  == "Early Stage Interviews" or interview["interview"]["name"]  == "HR Interview" ) and now("%Y%m%d") > interview["start"]["datetime"].strftime('%Y%m%d') %}
                        <hr />
                        <h5>Past interviews</h5>
                        {% include 'careers/application/_interview-card-done.html' %}
                    {% endif %}
                    </ul>
                {% endfor %}
  
                {% for interview in application["scheduled_interviews"] %}
                    {% if ( interview["interview"]["name"] == "Early Stage Interviews" or interview["interview"]["name"]  == "HR Interview" ) and now("%Y%m%d") < interview["start"]["datetime"].strftime('%Y%m%d') %}
                        <hr />
                        <h5>Next interview</h5>
                        {% include 'careers/application/_interview-card.html' %}
                    {% endif %}
                {% endfor %}
                </ul>
              </div>
            </div>
          </li>
          <li class="p-stepped-list__item">
            <h3 class='p-process-stepped-list__title u-no-margin--bottom'>
              {% if "stage_progress" in application and application["stage_progress"]["offer"] %}<span class="p-on-pass"><i class="p-icon--success"></i> </span>
              {% elif "stage_progress" in application and not application["stage_progress"]["offer"] and application["stage_progress"]["late_stage"] %}
              <span class="p-on-stage"></span> 
              {% else %}<span class="p-not-on-stage"></span> 
              {% endif %}
              Late stage                    
            </h3>
            <div class="p-stepped-list__content">
              <p>During this stage you will meet with some of our more senior leads and executives who will form part of your management team.</p>
              {% if "stage_progress" in application and application["stage_progress"]["offer"] %}
              <p onclick="showProgressDetail('late-stage')" class="show-more-late-stage" >Show more</p>
              <div class="progress-detail-late-stage u-hide">
              {% else %}
              <div class="progress-detail-late-stage">
              {% endif %}
                {% for interview in application["scheduled_interviews"]|reverse %}
                    {% if interview["interview"]["name"]  == "Late Stage Interviews" and now("%Y%m%d") > interview["start"]["datetime"].strftime('%Y%m%d') %}
                        <hr />
                        <h5>Past interviews</h5>
                        {% include 'careers/application/_interview-card.html' %}
                    {% endif %}
                    </ul>
                {% endfor %}
                {% for interview in application["scheduled_interviews"] %}
                {% if interview["interview"]["name"] == "Late Stage Interviews" and now("%Y%m%d") < interview["start"]["datetime"].strftime('%Y%m%d') %}
                        <hr />
                        <h5>Next interview</h5>
                        {% include 'careers/application/_interview-card.html' %}
                    {% endif %}
                {% endfor %}
                </ul>
              </div>
            </div>
          </li>
          <li class="p-stepped-list__item">
            <h3 class='p-process-stepped-list__title u-no-margin--bottom'>
              {% if "stage_progress" in application and application["stage_progress"]["offer"] %}
              <i class="p-icon--success"></i> 
              {% else %}<span class="p-not-on-stage"></span> 
              {% endif %}
              Offer
            </h3>                
          </li>
        </ol>
      </div>
    </section>

    <section class="p-strip--light is-deep">
      <div class="row">
        <div class="col-6">
          <h2>Hiring at Canonical</h2>
          <p>Mark Shuttleworth, CEO explains the hiring process at Canonical.</p>
        </div>
        <div class="col-6 u-embedded-media">
          <iframe class="u-embedded-media__element" src="https://player.vimeo.com/video/466106710?h=206809c045&amp;autopause=0&amp;player_id=0&amp;app_id=58479" width="560" height="315" frameborder="0" title="What is MicroK8s?"></iframe>
        </div>
      </div>
    </section>

    <section class="p-strip is-deep">
      <div class="u-fixed-width">
        <h2>Life at Canonical</h2>
      </div>
      <div class="row">
        <div class="p-strip">
          <div class="row">
            <div class="col-4 p-card has-accent-border">
              <h3 class="p-heading--4" id="product-heading">Lifestyle</h3>
              <p id="product-description">Canonical is amazing for people who are organised, passionate about technology, and like to travel. People at Canonical say the people at Canonical are amazing. That’s special.</p>
              <p id="product-link"><a href="/careers/lifestyle">Read more</a></p>
            </div>
            <div class="col-4 p-card has-accent-border">
              <h3 class="p-heading--4" id="product-heading">Ethics</h3>
              <p id="product-description">We take our responsibility for the most critical elements of every piece of open infrastructure in the software-defined world very seriously, and we are committed to quality in every aspect of our product and services.</p>
              <p id="product-link"><a href="/careers/ethics">Read more</a></p>
            </div>
            <div class="col-4 p-card has-accent-border">
              <h3 class="p-heading--4" id="product-heading">Travel</h3>
              <p id="product-description">We're uniquely global - we hire the best open source team globally, regardless of nationality or language, creed or colour, and we serve the global market for technology in open infrastructure and open applications.</p>
              <p id="product-link"><a href="/careers/travel">Read more</a></p>
            </div>
          </div>
          <div class="row">
            <div class="col-4 p-card has-accent-border">
              <h3 class="p-heading--4" id="product-heading">Progression</h3>
              <p id="product-description">We hire for talent, passion and work ethic. Your career at Canonical can progress in many ways - and we celebrate growth and development in many forms.</p>
              <p id="product-link"><a href="/careers/progression">Read more</a></p>
            </div>
            <div class="col-4 p-card has-accent-border">
              <h3 class="p-heading--4" id="product-heading">Diversity</h3>
              <p id="product-description">We believe that talent is evenly distributed around the world. No matter where you were born, or what you look like, or how you like to dress.</p>
              <p id="product-link"><a href="/careers/diversity">Read more</a></p>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <section class="p-strip--light is-deep">
      {% if withdrawal_requested %}
      <div class="u-fixed-width">
        <h2>You have requested to withdraw this application.</h2>
        <p>Your application will remain active until you click on the link we have sent you via email.</p>
        <p>If you experience any issues please contact your hiring lead.</p>
      </div>
      {% elif not withdrawal_requested and wrong_email %}
      <div class="u-fixed-width">
        <h2>We could not withdraw your application.</h2>
        <p>The email you entered does not match the email used to apply to this role. Please try again using the email you used in the application.</p>
        <button id="showModal" aria-controls="modal">Withdraw application</button>
        {% include "careers/application/_withdrawal-form.html" %}
      </div>
      {% else %}
      <div class="u-fixed-width">
        <h2>Do you wish to withdraw your application?</h2>
        <p>You will be asked for confirmation in the next steps.</p>
        <button id="showModal" aria-controls="modal">Withdraw application</button>
        {% include "careers/application/_withdrawal-form.html" %}
      </div>
      {% endif %}
    </section>

  {% elif application["status"] == "hired" %}
    <section class="p-strip">
      <div class="row">
        <h1>Thanks for applying {{ application["candidate"]["first_name"] }} {{ application["candidate"]["last_name"] }}!</h1>
        <p>
          <i class="p-icon--success"></i> You are hired! Welcome to Canonical.
        </p>
      </div>
    </section>
  {% else %}
    <section class="p-strip">
      <div class="row">
        <h1 class="u-sv3">Thanks for applying {{ application["candidate"]["first_name"] }} {{ application["candidate"]["last_name"] }}!</h1>
        <p>
          <i class="p-icon--error"></i> It seems your application on the role {{ application["jobs"][0]["name"] }} was rejected. 
          Check out <a href="/careers">our career page</a> to see if there 
          is another role that would match your skills!
        </p>
      </div>
    </section>
  {% endif %}
{% endblock %}
